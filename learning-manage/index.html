<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" media="screen and (max-width:650px)" href="mobile.css">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
</head>
<body>
<div class="container">
   <div class="content">
       <header>
       </header>
       <div class="gallery">
           <div class="button-left"></div>
           <div class="button-right"></div>
           <div class="carousel" id="carousel">
               <img src="images/gallery1.png" alt="">
               <img src="images/gallery2.png" alt="">
               <img src="images/gallery3.png" alt="">
               <img src="images/gallery4.png" alt="">
           </div>
           <div class="gallery-targgles">
               <div></div>
               <div></div>
               <div></div>
               <div></div>
           </div>
       </div>
       <a class="main-menu">
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <div>
               <span class="icon"></span>
               <span class="title">课堂表现</span>
           </div>
           <label>vskr</label>
       </a>

       <footer>

       </footer>
   </div>
</div>
<script>
    var i = 0;
        var carousel = document.getElementById("carousel");
        var galleryTarggles = document.querySelectorAll(".gallery-targgles > div");
        var isMouseDown = false;
        var mouseUpX;
        var mouseDownX;
        carousel.addEventListener("mousedown"
                ,function (e) {
                    e.preventDefault();
                    mouseDownX = e.pageX;
                    isMouseDown = true;
                    carousel.style.transition = "none";
        });
        carousel.addEventListener("mouseup"
                ,function (e) {
                    carousel.style.transition = "left 0.5s";
                    isMouseDown = false;
                    mouseUpX = e.pageX;
                    var subMouseX = mouseUpX-mouseDownX;
                    var delta = Math.abs(subMouseX);
                    if(delta > 120){
                        if(mouseDownX < mouseUpX){
                            //向右拖动
                            if(i>0){
                                i--;
                                carousel.style.left = -(i* gallery.offsetWidth) +"px";
                                for(var ii=0;ii<galleryTarggles.length;ii++){
                                    galleryTarggles[ii].style.backgroundColor="#fff";
                                }
                                galleryTarggles[i].style.backgroundColor="red";
                            }
                        }else {
                            //向左拖动
                            i++;
                            carousel.style.left = -(i* gallery.offsetWidth) +"px";
                            for(var ii=0;ii<galleryTarggles.length;ii++){
                                galleryTarggles[ii].style.backgroundColor="#fff";
                            }
                            galleryTarggles[i].style.backgroundColor="red";
                        }
                    }else {
                        carousel.style.left = -(i* gallery.offsetWidth) +"px";
                    }

        });
          var preMouseX;
        carousel.addEventListener("mousemove"
                ,function (e) {
                    var mouseX = e.pageX;
                    var subX = mouseX-preMouseX;
                 if (isMouseDown){
                     if(carousel.offsetLeft + subX < 0){
                         carousel.style.left = (carousel.offsetLeft+subX) + "px";
                     }
                 }else{
                 }
                    preMouseX = mouseX;
        });
        carousel.style.left = 0;

        var timeoutInterval;
       function runCarousel() {
           var gWidth= (gallery.clientWidth+gallery.offsetWidth)/2;
           var poiLeft= carousel.style.left;
           var left = poiLeft.substring(0,poiLeft.length-2);
           left = Number(left);
           left =left-gWidth;
           for(var ii=0;ii<galleryTarggles.length;ii++){
               galleryTarggles[ii].style.backgroundColor="#fff";
           }
           carousel.style.left=left + "px";
           i++;
           if(i>3){
               carousel.style.left="0px";
               i=0;

           }
           galleryTarggles[i].style.backgroundColor="red";
           timeoutInterval = setTimeout(runCarousel,3000);
       }
    galleryTarggles[i].style.backgroundColor="red";
        var gallery = document.querySelector(".gallery");
            timeoutInterval = setTimeout(runCarousel,3000);

          gallery.addEventListener("mouseenter",function () {

                clearTimeout(timeoutInterval);
        });
          gallery.addEventListener("mouseleave",function () {
              runCarousel();
        });

</script>
</body>
</html>